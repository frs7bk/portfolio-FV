# دليل نشر الموقع على Render

هذا الدليل يشرح خطوات نشر موقعك على منصة Render مع الحفاظ على جميع الميزات بما في ذلك الإشعارات وقاعدة البيانات.

## المتطلبات

قبل البدء، تأكد من أن لديك:

1. حساب على [Render](https://render.com/)
2. حساب على [Neon](https://neon.tech/) أو أي مزود قاعدة بيانات PostgreSQL أخرى
3. مفتاح API لخدمة SendGrid إذا كنت ترغب في استخدام ميزة البريد الإلكتروني
4. توكن بوت Telegram ومعرف الدردشة إذا كنت ترغب في استخدام ميزة إشعارات Telegram
5. مستودع GitHub (اختياري ولكن موصى به)

## الخطوة 1: إعداد قاعدة البيانات

### إعداد قاعدة بيانات PostgreSQL على Neon:

1. قم بإنشاء حساب على [Neon](https://neon.tech/)
2. أنشئ مشروعًا جديدًا واحصل على رابط الاتصال بقاعدة البيانات (DATABASE_URL)
3. احتفظ برابط الاتصال لاستخدامه لاحقًا في إعدادات Render

## الخطوة 2: تحضير المشروع للنشر

### ملفات أساسية

تأكد من وجود الملفات التالية في المشروع:

1. **app.py**: ملف التطبيق الرئيسي
2. **render.yaml**: يحتوي على إعدادات خدمة Render
3. **render-requirements.txt**: يحتوي على قائمة المكتبات المطلوبة
4. **render_setup.py**: سكربت إعداد بيئة Render
5. **.gitignore**: يستبعد الملفات غير الضرورية

### بنية المجلدات

تأكد من وجود المجلدات التالية (سيتم إنشاؤها تلقائيًا بواسطة سكربت الإعداد):
- `static/uploads`
- `static/uploads/profile`
- `static/uploads/portfolio`
- `static/uploads/carousel`
- `static/uploads/services`
- `static/uploads/projects`
- `instance`

## الخطوة 3: نشر المشروع على Render

### الطريقة 1: النشر من GitHub (موصى بها)

1. قم بنشر مشروعك على GitHub
2. قم بتسجيل الدخول إلى Render
3. انقر على "New" واختر "Blueprint"
4. اختر مستودع GitHub الخاص بك
5. سيكتشف Render ملف `render.yaml` ويقوم بإعداد الخدمة تلقائيًا
6. أضف متغيرات البيئة المطلوبة (انظر القسم أدناه)
7. انقر على "Apply"

### الطريقة 2: النشر المباشر

1. قم بتسجيل الدخول إلى Render
2. انقر على "New" واختر "Web Service"
3. اختر "Build and deploy from a Git repository"
4. اختر مستودع GitHub الخاص بك
5. املأ المعلومات التالية:
   - **Name**: اسم التطبيق (مثل portfolio-flask)
   - **Region**: اختر المنطقة الأقرب إليك
   - **Branch**: main (أو الفرع الذي تريد النشر منه)
   - **Runtime**: Python
   - **Build Command**: `pip install -r render-requirements.txt && python render_setup.py`
   - **Start Command**: `gunicorn --bind 0.0.0.0:$PORT --workers 4 app:app`
6. أضف متغيرات البيئة المطلوبة (انظر القسم أدناه)
7. انقر على "Create Web Service"

## الخطوة 4: إعداد متغيرات البيئة

في إعدادات الخدمة على Render، أضف متغيرات البيئة التالية:

| متغير | الوصف | إلزامي |
|--------|-------------|---------|
| DATABASE_URL | رابط اتصال قاعدة البيانات PostgreSQL | نعم |
| FLASK_SECRET_KEY | مفتاح سري عشوائي طويل للتطبيق | نعم |
| SESSION_SECRET | مفتاح سري عشوائي لجلسات المستخدمين | نعم |
| SENDGRID_API_KEY | مفتاح API لخدمة SendGrid | لا |
| TELEGRAM_BOT_TOKEN | توكن بوت Telegram | لا |
| TELEGRAM_CHAT_ID | معرف دردشة Telegram | لا |

## الخطوة 5: مراقبة النشر

1. انتظر حتى اكتمال عملية البناء والنشر
2. افحص سجلات النشر للتأكد من عدم وجود أخطاء
3. عند اكتمال النشر، انقر على رابط موقعك للتحقق من أنه يعمل بشكل صحيح

## الخطوة 6: إعداد المستخدم المسؤول

بعد النشر، يجب إنشاء مستخدم مسؤول لإدارة الموقع:

1. قم بزيارة `/admin/login` على موقعك المنشور
2. قم بإنشاء حساب جديد أو تسجيل الدخول إذا كان لديك حساب بالفعل

## ميزات Render المفيدة

1. **التوسع التلقائي**: يمكن لـ Render زيادة موارد الخدمة تلقائيًا عند الحاجة
2. **المراقبة المستمرة**: يقوم Render بمراقبة تطبيقك ويعيد تشغيله تلقائيًا إذا تعطل
3. **النشر التلقائي**: عند دفع تغييرات إلى مستودع GitHub، يمكن لـ Render إعادة نشر التطبيق تلقائيًا
4. **سجلات مباشرة**: يمكنك مشاهدة سجلات التطبيق في الوقت الفعلي من لوحة تحكم Render

## استكشاف الأخطاء وإصلاحها

### مشاكل قاعدة البيانات
- تحقق من صحة رابط الاتصال بقاعدة البيانات
- تأكد من أن قاعدة البيانات متاحة ويمكن الوصول إليها من Render
- استخدم واجهة Neon أو مزود قاعدة البيانات الخاص بك للتحقق من وجود الجداول

### مشاكل تحميل الملفات
- المجلد `static/uploads` يتم مسحه عند كل إعادة نشر، لذا قد تحتاج إلى استخدام خدمة تخزين خارجية مثل:
  - Amazon S3
  - Cloudinary
  - Firebase Storage

### مشاكل الإشعارات
- تحقق من متغيرات البيئة الخاصة بـ SendGrid و Telegram
- افحص سجلات التطبيق للحصول على أي أخطاء متعلقة بالإشعارات

## نصائح إضافية

1. **النسخ الاحتياطي**: قم بإعداد نسخ احتياطي منتظم لقاعدة البيانات
2. **المراقبة**: استخدم أدوات المراقبة المدمجة في Render لتتبع أداء التطبيق
3. **التخزين الدائم**: استخدم Render Disks أو خدمة تخزين خارجية للملفات التي تحتاج إلى البقاء بين إعادات النشر

---

إذا واجهت أي صعوبات أثناء النشر، يمكنك الرجوع إلى [وثائق Render](https://render.com/docs) أو طلب المساعدة من دعم Render.